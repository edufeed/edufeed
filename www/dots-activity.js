// Generated by LiveScript 1.3.1
(function(){
  RegisterActivity({
    is: 'dots-activity',
    properties: {
      numdots: {
        type: Number,
        value: 5,
        observer: 'createDots'
      }
    },
    S: function(pattern){
      return $(this.$$(pattern));
    },
    hideSelectionRectangle: function(){
      return this.S('#selection').hide();
    },
    selectionRectangle: function(startx, starty, endx, endy){
      var selection;
      selection = this.S('#selection');
      if (selection.length === 0) {
        selection = $('<div>').prop('id', 'selection');
        selection.appendTo(this);
      }
      selection.show();
      selection.offset({
        left: startx,
        top: starty
      });
      return selection.css({
        width: endx - startx,
        height: endy - starty
      });
    },
    createDots: function(){
      var numdots, spacing, i$, ref$, len$, i, lresult$, j$, ref1$, len1$, j, newdot, results$ = [];
      $(this).find('.colordot').remove();
      numdots = this.numdots;
      spacing = 100 / numdots;
      for (i$ = 0, len$ = (ref$ = (fn$())).length; i$ < len$; ++i$) {
        i = ref$[i$];
        lresult$ = [];
        for (j$ = 0, len1$ = (ref1$ = (fn1$())).length; j$ < len1$; ++j$) {
          j = ref1$[j$];
          newdot = $('<div>');
          newdot.css({
            width: '10px',
            height: '10px',
            'background-color': 'black',
            'border-radius': '50%',
            position: 'absolute',
            top: spacing * (i + 0.5) + 'vh',
            left: spacing * (j + 0.5) + 'vw'
          });
          newdot.addClass('colordot');
          lresult$.push(newdot.appendTo(this));
        }
        results$.push(lresult$);
      }
      return results$;
      function fn$(){
        var i$, to$, results$ = [];
        for (i$ = 0, to$ = numdots; i$ < to$; ++i$) {
          results$.push(i$);
        }
        return results$;
      }
      function fn1$(){
        var i$, to$, results$ = [];
        for (i$ = 0, to$ = numdots; i$ < to$; ++i$) {
          results$.push(i$);
        }
        return results$;
      }
    },
    ready: function(){
      /*
      this.S('#contents').on 'touchy-drag', (evt) ->
        console.log evt
      */
      var self;
      self = this;
      $(this).on('pointerdown', function(evt){
        self.drawing = true;
        self.startx = evt.offsetX;
        return self.starty = evt.offsetY;
      });
      $(this).on('pointermove', function(evt){
        var diffx, diffy;
        if (self.drawing) {
          diffx = self.startx - evt.offsetX;
          diffy = self.starty - evt.offsetY;
          console.log({
            diffx: diffx,
            diffy: diffy
          });
          return self.selectionRectangle(self.startx, self.starty, evt.offsetX, evt.offsetY);
        }
      });
      $(this).on('pointerout', function(evt){
        console.log('pointerout');
        self.drawing = false;
        return self.hideSelectionRectangle();
      });
      $(this).on('pointerleave', function(evt){
        console.log('pointerleave');
        self.drawing = false;
        return self.hideSelectionRectangle();
      });
      $(this).on('pointerup', function(evt){
        console.log('pointerup');
        self.drawing = false;
        return self.hideSelectionRectangle();
      });
      return console.log('activity started');
    }
  });
}).call(this);
